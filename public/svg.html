<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>D3.js Background Fixed, Square Scalable</title>
    <script src="https://d3js.org/d3.v5.min.js"></script>
</head>
<body>

<script>
    // 定义画布大小和初始缩放比例
    var width = 800,
        height = 600,
        initScale = 1;

    // 创建svg元素
    var svg = d3.select("body")
        .append("svg")
        .attr("width", width)
        .attr("height", height);

    // 创建页面容器
    var page = svg.append("g")
        .attr("class", "page")
        .attr("transform", "translate(0,0)scale(" + initScale + ")");

    // 加载背景图像
    // d3.xml("background.svg").mimeType("image/svg+xml").get(function(error, xml) {
    //     if (error) throw error;
    //     var importedNode = document.importNode(xml.documentElement, true);
    //     page.node().appendChild(importedNode);
    // });

    // 创建正方形元素
    var square = page.append("rect")
        .attr("class", "square")
        .attr("x", 300)
        .attr("y", 200)
        .attr("width", 200)
        .attr("height", 200)
        .attr("fill", "blue")
        .attr("stroke", "black");


    // 定义缩放函数
    var zoom = d3.zoom()
        .scaleExtent([0.5, 10])
        .on("zoom", zoomed);

    // 应用缩放函数
    svg.call(zoom);

    // 定义缩放回调函数
    function zoomed() {
        page.attr("transform", d3.event.transform);
        square.attr("transform", d3.event.transform);
    }
</script>

</body>
</html>
